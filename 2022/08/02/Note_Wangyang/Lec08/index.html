<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Lec08 Gradient computation | TeresaClay的小屋</title>
  <meta name="keywords" content="">
  <meta name="description" content="Lec08 Gradient computation | TeresaClay的小屋">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="To do read 蓝皮书:Chapter 5   run divergence例题    read 6.2 Numerical Schemes read Chapter 3 Numerical Method  Divergence schemesdivSchemes &amp;#123;     default         none;     div(phi,Q)      Gauss &lt;i">
<meta property="og:type" content="article">
<meta property="og:title" content="Lec10 Convection Term">
<meta property="og:url" content="https://teresaclay.github.io/2022/08/05/Note_Wangyang/Lec10/index.html">
<meta property="og:site_name" content="TeresaClay的小屋">
<meta property="og:description" content="To do read 蓝皮书:Chapter 5   run divergence例题    read 6.2 Numerical Schemes read Chapter 3 Numerical Method  Divergence schemesdivSchemes &amp;#123;     default         none;     div(phi,Q)      Gauss &lt;i">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-06_00-09.png">
<meta property="article:published_time" content="2022-08-05T08:04:41.282Z">
<meta property="article:modified_time" content="2022-08-07T21:47:26.267Z">
<meta property="article:author" content="TeresaClay">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-06_00-09.png">


<link rel="icon" href="/img/Teresa.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/zenbum.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 6.2.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>


<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/Teresa.jpg"/>
</a>
<div class="author">
    <span>TeresaClay</span>
</div>

<div class="icon">
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(25)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="工具">
                        
                        工具
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Andreas">
                        
                        Andreas
                        <small>(11)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="WangYang">
                        
                        WangYang
                        <small>(11)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="25">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>半离散方程</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>高斯散度定理</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>散度</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>梯度</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>通量</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>通用形式</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>旋度</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All WangYang "
           href="/2022/08/05/Note_Wangyang/Lec10/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec10 Convection Term">Lec10 Convection Term</span>
            <span class="post-date" title="2022-08-05 10:04:41">2022/08/05</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/08/02/Note_Wangyang/Lec08/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec08 Gradient computation">Lec08 Gradient computation</span>
            <span class="post-date" title="2022-08-02 22:12:16">2022/08/02</span>
        </a>
        
        
        <a  class="All 工具 "
           href="/2022/08/02/%E5%B7%A5%E5%85%B7/Vim/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Vim 基本使用">Vim 基本使用</span>
            <span class="post-date" title="2022-08-02 13:02:20">2022/08/02</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/27/Note_Wangyang/Lec06/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec06-07 The diffusion term">Lec06-07 The diffusion term</span>
            <span class="post-date" title="2022-07-27 15:21:06">2022/07/27</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/16/Note_Wangyang/Lec05/"
           data-tag="散度,梯度,旋度,高斯散度定理"
           data-author="" >
            <span class="post-title" title="Lec05 The Finite Volume Mesh">Lec05 The Finite Volume Mesh</span>
            <span class="post-date" title="2022-07-16 20:43:57">2022/07/16</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/14/Note_Wangyang/Lec04/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec04 The Finite Volume Method">Lec04 The Finite Volume Method</span>
            <span class="post-date" title="2022-07-14 16:38:06">2022/07/14</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/12/Note_Wangyang/Lec03/"
           data-tag="半离散方程,通量"
           data-author="" >
            <span class="post-title" title="Lec03 The Finite Volume Method">Lec03 The Finite Volume Method</span>
            <span class="post-date" title="2022-07-12 15:33:21">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec15/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec15 Die Energiebilanz in der Kontinummsmechanik">Lec15 Die Energiebilanz in der Kontinummsmechanik</span>
            <span class="post-date" title="2022-07-12 13:33:10">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec13/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec13 Innere Spannungen und Cauchygleichungen">Lec13 Innere Spannungen und Cauchygleichungen</span>
            <span class="post-date" title="2022-07-12 11:19:36">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec12/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec12,14 Deformation und Deformationstensor">Lec12,14 Deformation und Deformationstensor</span>
            <span class="post-date" title="2022-07-12 10:44:01">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec11/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec11 Die Druck-Poisson-Gleichung">Lec11 Die Druck-Poisson-Gleichung</span>
            <span class="post-date" title="2022-07-12 10:25:47">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec10/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec10 Stromlinien und Stromfunktion">Lec10 Stromlinien und Stromfunktion</span>
            <span class="post-date" title="2022-07-12 09:40:04">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/11/Andreas_Malcherek/Lec9/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec9 Gibt es rotationsfreie Strömungen">Lec9 Gibt es rotationsfreie Strömungen</span>
            <span class="post-date" title="2022-07-11 23:39:27">2022/07/11</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/11/Andreas_Malcherek/Lec8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec8 Das d&#39;Almebertsche Paradoxon">Lec8 Das d&#39;Almebertsche Paradoxon</span>
            <span class="post-date" title="2022-07-11 23:32:11">2022/07/11</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/10/Andreas_Malcherek/Lec6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec6-7 Hydraudynamische Druckberechnungen">Lec6-7 Hydraudynamische Druckberechnungen</span>
            <span class="post-date" title="2022-07-10 20:08:55">2022/07/10</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/10/Andreas_Malcherek/Lec4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec4 Die Potentialströmungen">Lec4 Die Potentialströmungen</span>
            <span class="post-date" title="2022-07-10 19:36:35">2022/07/10</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/09/Andreas_Malcherek/Lec2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec2-3 Kontinuitätsgleichung für kompressible Gleichung">Lec2-3 Kontinuitätsgleichung für kompressible Gleichung</span>
            <span class="post-date" title="2022-07-09 23:05:59">2022/07/09</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/09/Andreas_Malcherek/Lec1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec1 Lagrangesche Ableitung und Advektion">Lec1 Lagrangesche Ableitung und Advektion</span>
            <span class="post-date" title="2022-07-09 22:18:12">2022/07/09</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/Lec02/"
           data-tag="通用形式"
           data-author="" >
            <span class="post-title" title="Lec02 Mathematical Description of Physical Phenomena">Lec02 Mathematical Description of Physical Phenomena</span>
            <span class="post-date" title="2022-07-08 23:12:54">2022/07/08</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/Lec01/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec01 Vector Calculus">Lec01 Vector Calculus</span>
            <span class="post-date" title="2022-07-08 16:02:34">2022/07/08</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="安装环境">安装环境</span>
            <span class="post-date" title="2022-07-08 16:02:34">2022/07/08</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/%E7%9F%A5%E8%AF%86%E6%8B%93%E5%B1%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="拓展知识">拓展知识</span>
            <span class="post-date" title="2022-07-08 16:02:34">2022/07/08</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/Lec00/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec00 Introduction">Lec00 Introduction</span>
            <span class="post-date" title="2022-07-08 16:02:34">2022/07/08</span>
        </a>
        
        
        <a  class="All "
           href="/2022/07/08/Markdown_Note/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Cheat Sheet">Cheat Sheet</span>
            <span class="post-date" title="2022-07-08 08:28:52">2022/07/08</span>
        </a>
        
        
        <a  class="All "
           href="/2022/07/05/hello-world/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hello World">Hello World</span>
            <span class="post-date" title="2022-07-05 15:03:00">2022/07/05</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Note_Wangyang/Lec08" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Lec08 Gradient computation</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="WangYang">WangYang</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2022-08-07 23:25:34'>2022-08-02 22:12</time>
        
    </div>
    <div class="article-meta">
        
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#To-do"><span class="toc-text">To do</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%AD%A3%E4%BA%A4computing-gradients-in-cartesian-grides"><span class="toc-text">正交computing gradients in cartesian grides</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%9E%E6%AD%A3%E4%BA%A4-Green-Gauss-Gradient"><span class="toc-text">非正交 Green-Gauss Gradient</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#face-based-gradient-computation"><span class="toc-text">face-based gradient computation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#non-orthogonal"><span class="toc-text">non-orthogonal:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#skewness"><span class="toc-text">skewness:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95-1-%EF%BC%88face-based-gradient-computation"><span class="toc-text">计算方法 1 （face-based gradient computation)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95-2-face-based-gradient-computation"><span class="toc-text">计算方法 2 (face-based gradient computation)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95-3-face-based-gradient-computation"><span class="toc-text">计算方法 3 (face-based gradient computation)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-1-P280"><span class="toc-text">Example 1 P280</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#node-based-gradient-computation"><span class="toc-text">node-based gradient computation</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95"><span class="toc-text">最小二乘法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#F101"><span class="toc-text">F101</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Example"><span class="toc-text">Example</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#book"><span class="toc-text">book</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A2%AF%E5%BA%A6%E5%B0%8F%E7%BB%93-nabla-phi-f"><span class="toc-text">梯度小结 $(\nabla\phi)_f$</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="To-do"><a href="#To-do" class="headerlink" title="To do"></a>To do</h1><ul>
<li>101F:26-28</li>
<li>Tipcs and Tricks in OpenFOAM</li>
<li><a target="_blank" rel="noopener" href="https://www.cfd-online.com/Forums/openfoam-solving/124345-gradient-schemes.html">CFD-online: gradient schemes</a></li>
<li><p><a target="_blank" rel="noopener" href="https://www.cfd-online.com/Forums/openfoam-solving/81486-cellmdlimited-vs-celllimited.html">cellMDLimited vs. cellLimited</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/UnnamedMoose/BasicOpenFOAMProgrammingTutorials">OpenFOAM programming tutorials</a></p>
</li>
<li>Chalmers Programm</li>
<li>视频中Programm的部分</li>
</ul>
<hr>
<p><a target="_blank" rel="noopener" href="https://www.openfoam.com/documentation/guides/v2112/doc/guide-schemes-gradient.html">梯度</a></p>
<pre><code class="lang-c++">gradSchemes
&#123;
    default         none;
    grad(p)         &lt;optional limiter&gt; &lt;gradient scheme&gt; &lt;interpolation scheme&gt;;
&#125;
</code></pre>
<div class="table-container">
<table>
<thead>
<tr>
<th>limiter</th>
<th>gradient</th>
<th>interpolation</th>
</tr>
</thead>
<tbody>
<tr>
<td>cellLimited<br><font color=blue>cellMDLimited</font><br>faceLimited<br>faceMDLimited</td>
<td>Gauss<br>leastSquares</td>
<td>linear<br>pointLinear<br>leastSquares </td>
</tr>
</tbody>
</table>
</div>
<h1 id="正交computing-gradients-in-cartesian-grides"><a href="#正交computing-gradients-in-cartesian-grides" class="headerlink" title="正交computing gradients in cartesian grides"></a>正交computing gradients in cartesian grides</h1><p><img align="right" src=https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-02-22-59-17.png></p>
<ul>
<li>1D</li>
</ul>
<p><img align="right" src=https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-02-23-02-38.png></p>
<script type="math/tex; mode=display">
  \left(\frac{\mathrm{d}\phi}{\mathrm{d}x}     \right)_e=\frac{\phi_E-\phi_P}{x_E-x_P}</script><ul>
<li>2D<script type="math/tex; mode=display">
\left(\frac{\partial \phi}{\partial x}\right)_P=\frac{\phi_E-\phi_W}{x_E-x_W}\\
\left(\frac{\partial \phi}{\partial x}\right)_P=\frac{\phi_N-\phi_S}{x_N-x_S}</script></li>
</ul>
<hr>
<h1 id="非正交-Green-Gauss-Gradient"><a href="#非正交-Green-Gauss-Gradient" class="headerlink" title="非正交 Green-Gauss Gradient"></a>非正交 Green-Gauss Gradient</h1><p>体心梯度</p>
<script type="math/tex; mode=display">
(\nabla \phi)_P=\frac{1}{V_P}\sum_{f}\phi_f\cdot \boldsymbol{S}_f</script><ul>
<li>两种方法计算 $\phi_f$<ol>
<li><font color=blue>face-based</font></li>
<li>vertex-based</li>
</ol>
</li>
</ul>
<h2 id="face-based-gradient-computation"><a href="#face-based-gradient-computation" class="headerlink" title="face-based gradient computation"></a>face-based gradient computation</h2><h3 id="non-orthogonal"><a href="#non-orthogonal" class="headerlink" title="non-orthogonal:"></a>non-orthogonal:</h3><script type="math/tex; mode=display">
\phi_f=\gamma \phi_P+(1-\gamma)\phi_N \qquad \gamma=\frac{\left\vert \vec{r}_N-\vec{r}_f     \right\vert }{\left\vert \vec{r}_N-\vec{r}_P \right\vert }=\frac{d_{Nf}}{d_{NP}}</script><ul>
<li>精度较低</li>
<li>二阶精度 $\phi_f=\frac{\phi_P+\phi_N}{2}$</li>
</ul>
<p>最终可计算面心梯度   $\qquad \qquad \color{green}{ \phi_f \to (\nabla \phi)_P\text{ and }(\nabla \phi)_N \to (\nabla \phi)_f }$</p>
<script type="math/tex; mode=display">
  \boxed{(\nabla \phi)_f=\gamma(\nabla \phi)_P+（1-\gamma)(\nabla \phi)_N}</script><p><img align="center" src=https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-02-23-09-13.png></p>
<h3 id="skewness"><a href="#skewness" class="headerlink" title="skewness:"></a>skewness:</h3><ul>
<li>skewness $\phi_{f^{‘}}$</li>
<li><p>泰勒公式</p>
<script type="math/tex; mode=display">
\begin{aligned}
\phi_f&=\phi_{f^{'}}+{\color{blue}{\text{correction}}}
\\ &=\phi_{f^{'}}+\left(\nabla \phi\right)_{f^{'}}\cdot (\vec{r}_{f}-\vec{r}_{f^{'}})+O(\Delta \vec{r}^{2}) 
\\ &=\gamma \left[ \phi_p+(\nabla \phi)_P\cdot (\vec{r}_f-\vec{r}_P)\right]+(1-\gamma)\left[\phi_N+(\nabla \phi)_N\cdot (\vec{r}_f-\vec{r}_N)\right] 
\\ &=\phi_{f^{'}}+{\color{blue}{\gamma(\nabla \phi)_{P}\cdot (\vec{r}_{f}-\vec{r}_{P})+(1-\gamma)(\nabla \phi)_N\cdot (\vec{r}_{f}-\vec{r}_{N})}}
\end{aligned}</script></li>
<li><p>可以选择有或没有corrected (To do:对应一下fvScheme and fvSolution)</p>
</li>
<li><p>由于 $\phi_f$ 造成了迭代问题</p>
</li>
</ul>
<p><img align="center" src=https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-05_15-25.png></p>
<h3 id="计算方法-1-（face-based-gradient-computation"><a href="#计算方法-1-（face-based-gradient-computation" class="headerlink" title="计算方法 1 （face-based gradient computation)"></a>计算方法 1 （face-based gradient computation)</h3><p><img src="https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-02-23-47-39.png" alt=""></p>
<ul>
<li>一般2-3次迭代</li>
</ul>
<h3 id="计算方法-2-face-based-gradient-computation"><a href="#计算方法-2-face-based-gradient-computation" class="headerlink" title="计算方法 2 (face-based gradient computation)"></a>计算方法 2 (face-based gradient computation)</h3><script type="math/tex; mode=display">
\gamma=0.5</script><p><img src="https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-05_15-17.png" alt=""></p>
<h3 id="计算方法-3-face-based-gradient-computation"><a href="#计算方法-3-face-based-gradient-computation" class="headerlink" title="计算方法 3 (face-based gradient computation)"></a>计算方法 3 (face-based gradient computation)</h3><h3 id="Example-1-P280"><a href="#Example-1-P280" class="headerlink" title="Example 1 P280"></a>Example 1 P280</h3><div class="table-container">
<table>
<thead>
<tr>
<th>体心点</th>
<th>坐标</th>
<th>$\phi$</th>
<th>$\nabla \phi$</th>
<th>$f_i=\frac{n_i+n_{i+1}}{2}$</th>
<th>$\vec{S}_{f_{i}}$</th>
<th>$\gamma$</th>
<th>$\phi_{f_i}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>C</td>
<td>$\begin{bmatrix} 13 \\ 11 \\\end{bmatrix}$</td>
<td>167</td>
<td>${\color{red}{(\nabla \phi)_C}=}\frac{1}{V_C}\sum_{i}\phi_{f_{i}}\vec{S}_{f_{i}}=\begin{bmatrix} 11.889 \\ 12.433 \\\end{bmatrix}$</td>
<td>—</td>
<td>—</td>
<td>—</td>
</tr>
<tr>
<td>$F_1$</td>
<td>$\begin{bmatrix} 4.5 \\ 9.5 \\\end{bmatrix}$</td>
<td>56.75</td>
<td>$\begin{bmatrix} 10.5 \\ 5.5 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 8.5 \\ 11 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} -6 \\ 1 \\\end{bmatrix}$</td>
<td>0.487</td>
<td>110.442</td>
</tr>
<tr>
<td>$F_2$</td>
<td>$\begin{bmatrix} 8 \\ 3 \\\end{bmatrix}$</td>
<td>35</td>
<td>$\begin{bmatrix} -4 \\ 9 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 10 \\ 6.5 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} -3 \\ -4 \\\end{bmatrix}$</td>
<td>0.427</td>
<td>91.364</td>
</tr>
<tr>
<td>$F_3$</td>
<td>$\begin{bmatrix} 17 \\ 3.5 \\\end{bmatrix}$</td>
<td>80</td>
<td>$\begin{bmatrix} -4.5 \\ 18 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 14.5 \\ 7 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 4 \\ -5 \\\end{bmatrix}$</td>
<td>0.502</td>
<td>123.674</td>
</tr>
<tr>
<td>$F_4$</td>
<td>$\begin{bmatrix} 22 \\ 10 \\\end{bmatrix}$</td>
<td>252</td>
<td>$\begin{bmatrix} 11 \\ 23 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 17.25 \\ 11.5 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 5 \\ -0.5 \\\end{bmatrix}$</td>
<td>0.538</td>
<td>206.27</td>
</tr>
<tr>
<td>$F_5$</td>
<td>$\begin{bmatrix} 16 \\ 20 \\\end{bmatrix}$</td>
<td>356</td>
<td>$\begin{bmatrix} 21 \\ 17 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 14.74 \\15.5  \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 3 \\ 5.5 \\\end{bmatrix}$</td>
<td>0.492</td>
<td>263.012</td>
</tr>
<tr>
<td>$F_6$</td>
<td>$\begin{bmatrix} 7 \\ 18 \\\end{bmatrix}$</td>
<td>151</td>
<td>$\begin{bmatrix} 19 \\ 8 \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} 10.5 \\ 15.5  \\\end{bmatrix}$</td>
<td>$\begin{bmatrix} -3 \\ 3 \\\end{bmatrix}$</td>
<td>0.455</td>
<td>158.28</td>
</tr>
</tbody>
</table>
</div>
<p>$V_C=76$</p>
<ul>
<li><p>The Green-Gauss method with no correction</p>
<p>$  \gamma=\frac{}{}=\begin{bmatrix}  \\  \\  \\  \\  \\  \\\end{bmatrix} \qquad \phi_{f}=\gamma\phi_C+(1-\gamma)\phi_{F_{i}}=\begin{bmatrix}  \\  \\  \\  \\  \\  \\\end{bmatrix}$</p>
</li>
<li><p>The Green-Gauss method with skewness correction ($\gamma=0.5$)<br>$\phi_{f^{‘}}=0.5(\phi_C+\phi_{F_{i}})=\begin{bmatrix}  \\  \\  \\  \\  \\  \\\end{bmatrix} \quad (\nabla \phi)_C=\frac{1}{V_C}\sum_{i}\phi_{f^{‘}}= \quad $ </p>
</li>
</ul>
<hr>
<h2 id="node-based-gradient-computation"><a href="#node-based-gradient-computation" class="headerlink" title="node-based gradient computation"></a>node-based gradient computation</h2><h1 id="最小二乘法"><a href="#最小二乘法" class="headerlink" title="最小二乘法"></a>最小二乘法</h1><h2 id="F101"><a href="#F101" class="headerlink" title="F101"></a>F101</h2><p>扩散项 $\to (\nabla \phi)_f \to (\nabla \phi)_P=\frac{1}{V_P}\sum_{}\phi_f\vec{S}_f$</p>
<p>Ex. 温度 $T$</p>
<script type="math/tex; mode=display">
\begin{aligned}
(\nabla T)_P&=\frac{1}{V_P}\left(T_1\vec{S}_{f_1}+T_2\vec{S}_{f_2}+ \cdots +T_6\vec{S}_{f_6}\right) \\T_N&=T_P+\vec{d}_{PN}\cdot (\nabla T)_P
\\ \phi_N &=\phi_P+(\nabla \phi)_{P}\cdot (\vec{r}_N-\vec{r}_P) \\ 泰勒公式: & f(x)=f(x_0)+f^{'}(x_0)(x-x_0)+\color{grey}{\frac{f^{''}(x_0)}{2!}(x-x_0)^{2}}  
\end{aligned}</script><script type="math/tex; mode=display">
\begin{aligned}
\\ T_1&=T_P+(\nabla T)_P \cdot \vec{r}_{P1} \\ T_1&=T_P+(\nabla T)_P \cdot \vec{r}_{P2} \\ \vdots \\ \\ T_6&=T_P+(\nabla T)_P \cdot \vec{r}_{P6}   \\
\end{aligned} \qquad   \qquad 
 \begin{bmatrix} r_{P1,x} & r_{P1,y}  & r_{P1,z} \\ r_{P2,x} & r_{P 2,y} & r_{P 3,z} \\ \vdots & \vdots & \vdots  \\ r_{P 6,x} & r_{P 6,y} & r_{P 6,z} \\\end{bmatrix}\begin{bmatrix} \frac{\partial T}{\partial x} \\ \frac{\partial T}{\partial y} \\ \frac{\partial T}{\partial z} \\\end{bmatrix} = \begin{bmatrix} T_1-T_P \\ T_2-T_P \\ \vdots \\ T_6-T_P \\\end{bmatrix}  \\ \qquad \\ \underbrace{A^{T}A}_{G}x=A^{T}b \\ (\nabla T)_P=G^{-1}A^{T}b</script><p>Note:没有插值，精度较高,但是G占用内存</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p><img src="https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-05_10-48.png" alt=""></p>
<script type="math/tex; mode=display">
A=\begin{bmatrix} 1 & 0 & 0 \\ 0 & 1 & 0 \\ -1 & 0 & 0 \\ 0 & -1 & 0 \\\end{bmatrix} \quad A^{T}=\begin{bmatrix} 1 & 0 & -1 & 0 \\ 0 & 1 & 0 & -1 \\ 0 & 0 & 0 & 0 \\\end{bmatrix} \quad G=A^{T}A=\begin{bmatrix} 2 &0  & 0  \\ 0 & 2 & 0 \\ 0 & 0 & 0 \\\end{bmatrix} \quad G^{-1}=\begin{bmatrix} \frac{1}{2} & 0 & 0 \\ 0 & \frac{1}{2} & 0 \\ 0 & 0 & 0 \\\end{bmatrix} \quad b=\begin{bmatrix} 100 \\ 100 \\ -100 \\ -100 \\\end{bmatrix} 
\\ \qquad \\ \begin{aligned}
(\nabla T)_P&=G^{-1}A^{T}b =\color{grey}{\begin{bmatrix} \frac{1}{2} & 0 & 0 \\ 0 & \frac{1}{2} & 0 \\ 0 & 0 & 0 \\\end{bmatrix} \begin{bmatrix} 1 & 0 & -1 & 0 \\ 0 & 1 & 0 & -1 \\ 0 & 0 & 0 & 0 \\\end{bmatrix}\begin{bmatrix} 100 \\ 100 \\ -100 \\ -100 \\\end{bmatrix}}=\begin{bmatrix} 100 \\ 100 \\ 0 \\\end{bmatrix}
\end{aligned}</script><h2 id="book"><a href="#book" class="headerlink" title="book"></a>book</h2><script type="math/tex; mode=display">
\begin{aligned}
\phi_N &=\phi_P+(\nabla \phi)_P\cdot (\vec{r}_N-\vec{r}_P) \qquad \qquad w_i=\frac{1}{\left\vert \vec{r}_P-\vec{r}_i \right\vert} \\ G&=\sum_{i=1} \{w_i\left[\phi_N-\left(  \phi_P+(\nabla \phi)_P\cdot\vec{r}_{PN}   \right)    \right]^{2} \} \\ &=\sum_{i=1}\{w_i\left[ \Delta \phi_i - \left(     \Delta x_i \left(\frac{\partial \phi}{\partial x}\right)_{P} +  \Delta y_i\left(\frac{\partial \phi}{\partial y} \right)_{P}+\Delta z_{i}\left(\frac{\partial \phi}{\partial z}\right)_{P} \right)  \right]^{2}\}
\end{aligned}</script><script type="math/tex; mode=display">
\boxed{ \frac{\partial G}{ \frac{\partial \phi}{\partial x}}=\frac{\partial G}{\frac{\partial \phi}{\partial y}}=\frac{\partial G}{\frac{\partial \phi}{\partial z}}=0}</script><script type="math/tex; mode=display">\color{grey}{\sum_{i=1}\left\{ 2w_i\left[ \Delta \phi_i - \left(\Delta x_i \left(\frac{\partial \phi}{\partial x}\right)_{P} +  \Delta y_i\left(\frac{\partial \phi}{\partial y} \right)_{P}+\Delta z_{i}\left(\frac{\partial \phi}{\partial z}\right)_{P} \right)  \right] \Delta x_i \right\}=0} 
\\ \color{grey}{\sum_{i=1}\left\{ 2w_i\left[ \Delta \phi_i - \left(     \Delta x_i \left(\frac{\partial \phi}{\partial x}\right)_{P} +  \Delta y_i\left(\frac{\partial \phi}{\partial y} \right)_{P}+\Delta z_{i}\left(\frac{\partial \phi}{\partial z}\right)_{P} \right)  \right] \Delta y_i \right\}=0} 
\\ \color{grey}{\sum_{i=1}\left\{ 2w_i\left[ \Delta \phi_i - \left(     \Delta x_i \left(\frac{\partial \phi}{\partial x}\right)_{P} +  \Delta y_i\left(\frac{\partial \phi}{\partial y} \right)_{P}+\Delta z_{i}\left(\frac{\partial \phi}{\partial z}\right)_{P} \right)  \right] \Delta z_i \right\}=0}
\\ \qquad \\ \color{grey}{\sum_{i=1}2w_i\Delta \phi_i \Delta x_i=\left( \sum_{i=1}(\Delta x_i)^{2}, \sum_{i=1}(\Delta x_i \Delta y_i),\sum_{i=1}\Delta x_i \Delta z_i \right) \cdot (\nabla  \phi)_P}
\\ \color{grey}{\sum_{i=1}2w_i\Delta \phi_i \Delta y_i=\left( \sum_{i=1}(\Delta x_i \Delta y_i), \sum_{i=1}(\Delta y_i)^{2},\sum_{i=1}\Delta y_i \Delta z_i \right) \cdot (\nabla  \phi)_P}
\\ \color{grey}{\sum_{i=1}2w_i\Delta \phi_i \Delta z_i=\left( \sum_{i=1}(\Delta x_i \Delta z_i), \sum_{i=1}(\Delta y_i \Delta z_i),\sum_{i=1} (\Delta z_i)^{2} \right) \cdot (\nabla  \phi)_P} 
\\ \qquad \\
\begin{bmatrix}  \sum_{i=1}(\Delta x_i)^{2} & \sum_{i=1}(\Delta x_i \Delta y_i) &  \sum_{i=1}\Delta x_i \Delta z_i\\  \sum_{i=1}(\Delta x_i \Delta y_i) & \sum_{i=1}(\Delta y_i)^{2} & \sum_{i=1}\Delta y_i \Delta z_i \\ \sum_{i=1}(\Delta x_i \Delta z_i) & \sum_{i=1}(\Delta y_i \Delta z_i) &\sum_{i=1} (\Delta z_i)^{2} \\ \end{bmatrix} \begin{bmatrix} \frac{\partial \phi}{\partial x} \\ \frac{\partial \phi}{\partial y} \\ \frac{\partial \phi}{\partial z} \\\end{bmatrix}_{P}=\begin{bmatrix} \sum_{i=1}2w_i\Delta \phi_i \Delta x_i  \\ \sum_{i=1}2w_i\Delta \phi_i \Delta y_i  \\ \sum_{i=1}2w_i\Delta \phi_i \Delta z_i \\\end{bmatrix}</script><ul>
<li>Interpolating gradients to faces</li>
</ul>
<h1 id="梯度小结-nabla-phi-f"><a href="#梯度小结-nabla-phi-f" class="headerlink" title="梯度小结 $(\nabla\phi)_f$"></a>梯度小结 $(\nabla\phi)_f$</h1><p><img align="right" src=https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-05_13-28.png></p>
<script type="math/tex; mode=display">
(\nabla \phi)_f \to \begin{cases}
  (1) \, \frac{\phi_P-\phi_N}{d_{PN}} \\ (2) \, \gamma(\nabla \phi)_P+(1-\gamma)(\nabla \phi)_N \quad \\ \qquad \gamma=\frac{\overrightarrow{fN}}{\overrightarrow{Pf}+\overrightarrow{fN}} \\ \qquad (\nabla \phi)_P=\frac{1}{V_P}\sum_{f}\phi_f\vec{S}_f \\ \qquad \phi_f=\phi_{f^{'}}=\gamma_2 \phi_P+(1-\gamma_2)\phi_N \quad \gamma_2=\frac{\overrightarrow{f^{'}N}}{PN}
\end{cases}</script><ul>
<li>$\gamma,\gamma_{2}$ 需要再理解</li>
</ul>

      
       
    </div>
</article>







    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="//cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<input type="hidden" id="MathJax-js"
        value="//cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</input>
    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2022 TeresaClay
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 642px;
    }
    .nav.fullscreen {
        margin-left: -642px;
    }
    .nav-left {
        width: 220px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 592px;
        }
        .nav.fullscreen {
            margin-left: -592px;
        }
        .nav-left {
            width: 200px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 592px;
            margin-left: -592px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
    #post .pjax article :not(pre) > code {
        color: #24292e;
        font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
        background-color: rgba(27,31,35,.05);
        border-radius: 3px;
        font-size: 85%;
        margin: 0;
        padding: .2em .4em;
    }
    
</style>







</html>
