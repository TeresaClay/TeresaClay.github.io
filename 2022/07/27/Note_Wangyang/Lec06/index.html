<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Lec06-07 The diffusion term | TeresaClay的小屋</title>
  <meta name="keywords" content="">
  <meta name="description" content="Lec06-07 The diffusion term | TeresaClay的小屋">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="To do read 蓝皮书:Chapter 5   run divergence例题    read 6.2 Numerical Schemes read Chapter 3 Numerical Method  Divergence schemesdivSchemes &amp;#123;     default         none;     div(phi,Q)      Gauss &lt;i">
<meta property="og:type" content="article">
<meta property="og:title" content="Lec10 Convection Term">
<meta property="og:url" content="https://teresaclay.github.io/2022/08/05/Note_Wangyang/Lec10/index.html">
<meta property="og:site_name" content="TeresaClay的小屋">
<meta property="og:description" content="To do read 蓝皮书:Chapter 5   run divergence例题    read 6.2 Numerical Schemes read Chapter 3 Numerical Method  Divergence schemesdivSchemes &amp;#123;     default         none;     div(phi,Q)      Gauss &lt;i">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-06_00-09.png">
<meta property="article:published_time" content="2022-08-05T08:04:41.282Z">
<meta property="article:modified_time" content="2022-08-07T21:47:26.267Z">
<meta property="article:author" content="TeresaClay">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-06_00-09.png">


<link rel="icon" href="/img/Teresa.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/zenbum.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 6.2.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>


<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/Teresa.jpg"/>
</a>
<div class="author">
    <span>TeresaClay</span>
</div>

<div class="icon">
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="All">All
            
                <small>(25)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="工具">
                        
                        工具
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Andreas">
                        
                        Andreas
                        <small>(11)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="WangYang">
                        
                        WangYang
                        <small>(11)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="25">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        Links
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">All</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>半离散方程</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>高斯散度定理</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>散度</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>梯度</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>通量</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>通用形式</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>旋度</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="All WangYang "
           href="/2022/08/05/Note_Wangyang/Lec10/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec10 Convection Term">Lec10 Convection Term</span>
            <span class="post-date" title="2022-08-05 10:04:41">2022/08/05</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/08/02/Note_Wangyang/Lec08/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec08 Gradient computation">Lec08 Gradient computation</span>
            <span class="post-date" title="2022-08-02 22:12:16">2022/08/02</span>
        </a>
        
        
        <a  class="All 工具 "
           href="/2022/08/02/%E5%B7%A5%E5%85%B7/Vim/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Vim 基本使用">Vim 基本使用</span>
            <span class="post-date" title="2022-08-02 13:02:20">2022/08/02</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/27/Note_Wangyang/Lec06/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec06-07 The diffusion term">Lec06-07 The diffusion term</span>
            <span class="post-date" title="2022-07-27 15:21:06">2022/07/27</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/16/Note_Wangyang/Lec05/"
           data-tag="散度,梯度,旋度,高斯散度定理"
           data-author="" >
            <span class="post-title" title="Lec05 The Finite Volume Mesh">Lec05 The Finite Volume Mesh</span>
            <span class="post-date" title="2022-07-16 20:43:57">2022/07/16</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/14/Note_Wangyang/Lec04/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec04 The Finite Volume Method">Lec04 The Finite Volume Method</span>
            <span class="post-date" title="2022-07-14 16:38:06">2022/07/14</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/12/Note_Wangyang/Lec03/"
           data-tag="半离散方程,通量"
           data-author="" >
            <span class="post-title" title="Lec03 The Finite Volume Method">Lec03 The Finite Volume Method</span>
            <span class="post-date" title="2022-07-12 15:33:21">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec15/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec15 Die Energiebilanz in der Kontinummsmechanik">Lec15 Die Energiebilanz in der Kontinummsmechanik</span>
            <span class="post-date" title="2022-07-12 13:33:10">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec13/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec13 Innere Spannungen und Cauchygleichungen">Lec13 Innere Spannungen und Cauchygleichungen</span>
            <span class="post-date" title="2022-07-12 11:19:36">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec12/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec12,14 Deformation und Deformationstensor">Lec12,14 Deformation und Deformationstensor</span>
            <span class="post-date" title="2022-07-12 10:44:01">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec11/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec11 Die Druck-Poisson-Gleichung">Lec11 Die Druck-Poisson-Gleichung</span>
            <span class="post-date" title="2022-07-12 10:25:47">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/12/Andreas_Malcherek/Lec10/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec10 Stromlinien und Stromfunktion">Lec10 Stromlinien und Stromfunktion</span>
            <span class="post-date" title="2022-07-12 09:40:04">2022/07/12</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/11/Andreas_Malcherek/Lec9/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec9 Gibt es rotationsfreie Strömungen">Lec9 Gibt es rotationsfreie Strömungen</span>
            <span class="post-date" title="2022-07-11 23:39:27">2022/07/11</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/11/Andreas_Malcherek/Lec8/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec8 Das d&#39;Almebertsche Paradoxon">Lec8 Das d&#39;Almebertsche Paradoxon</span>
            <span class="post-date" title="2022-07-11 23:32:11">2022/07/11</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/10/Andreas_Malcherek/Lec6/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec6-7 Hydraudynamische Druckberechnungen">Lec6-7 Hydraudynamische Druckberechnungen</span>
            <span class="post-date" title="2022-07-10 20:08:55">2022/07/10</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/10/Andreas_Malcherek/Lec4/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec4 Die Potentialströmungen">Lec4 Die Potentialströmungen</span>
            <span class="post-date" title="2022-07-10 19:36:35">2022/07/10</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/09/Andreas_Malcherek/Lec2/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec2-3 Kontinuitätsgleichung für kompressible Gleichung">Lec2-3 Kontinuitätsgleichung für kompressible Gleichung</span>
            <span class="post-date" title="2022-07-09 23:05:59">2022/07/09</span>
        </a>
        
        
        <a  class="All Andreas "
           href="/2022/07/09/Andreas_Malcherek/Lec1/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec1 Lagrangesche Ableitung und Advektion">Lec1 Lagrangesche Ableitung und Advektion</span>
            <span class="post-date" title="2022-07-09 22:18:12">2022/07/09</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/Lec02/"
           data-tag="通用形式"
           data-author="" >
            <span class="post-title" title="Lec02 Mathematical Description of Physical Phenomena">Lec02 Mathematical Description of Physical Phenomena</span>
            <span class="post-date" title="2022-07-08 23:12:54">2022/07/08</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/Lec01/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec01 Vector Calculus">Lec01 Vector Calculus</span>
            <span class="post-date" title="2022-07-08 16:02:34">2022/07/08</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="安装环境">安装环境</span>
            <span class="post-date" title="2022-07-08 16:02:34">2022/07/08</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/%E7%9F%A5%E8%AF%86%E6%8B%93%E5%B1%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="拓展知识">拓展知识</span>
            <span class="post-date" title="2022-07-08 16:02:34">2022/07/08</span>
        </a>
        
        
        <a  class="All WangYang "
           href="/2022/07/08/Note_Wangyang/Lec00/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Lec00 Introduction">Lec00 Introduction</span>
            <span class="post-date" title="2022-07-08 16:02:34">2022/07/08</span>
        </a>
        
        
        <a  class="All "
           href="/2022/07/08/Markdown_Note/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Cheat Sheet">Cheat Sheet</span>
            <span class="post-date" title="2022-07-08 08:28:52">2022/07/08</span>
        </a>
        
        
        <a  class="All "
           href="/2022/07/05/hello-world/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="Hello World">Hello World</span>
            <span class="post-date" title="2022-07-05 15:03:00">2022/07/05</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Note_Wangyang/Lec06" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Lec06-07 The diffusion term</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="WangYang">WangYang</a>
            
        </span>
        
        
    </div>
    <div class="article-meta">
        
            Created At : <time class="date" title='Updated At: 2022-08-07 20:19:13'>2022-07-27 15:21</time>
        
    </div>
    <div class="article-meta">
        
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E7%BB%B4%E6%89%A9%E6%95%A3%E6%96%B9%E7%A8%8B"><span class="toc-text">二维扩散方程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%BB%E6%95%A3-%EF%BC%88Two-dimensional-diffusion-in-a-rectangular-domain"><span class="toc-text">离散 （Two dimensional diffusion in a rectangular domain)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E9%A1%B9"><span class="toc-text">源项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E6%95%B0%E6%96%B9%E7%A8%8B"><span class="toc-text">代数方程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Boundary-condition"><span class="toc-text">Boundary condition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interface-diffusivity"><span class="toc-text">Interface diffusivity</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Example-1-P227"><span class="toc-text">Example 1 P227</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9D%9E%E7%BB%93%E6%9E%84%E5%8C%96%E7%BD%91%E6%A0%BC-non-orthogonal"><span class="toc-text">非结构化网格 non orthogonal</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E5%88%86%E8%A7%A3%E6%96%B9%E5%BC%8F"><span class="toc-text">三种分解方式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%8D%E4%B9%A0"><span class="toc-text">复习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Algebraic-equation-for-non-orthogonal-meshes"><span class="toc-text">Algebraic equation for non-orthogonal meshes</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E5%BD%A2%E5%BC%8F"><span class="toc-text">矩阵形式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Example-2-P246"><span class="toc-text">Example 2 (P246)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Boundary-conditions-for-non-orthogonal-grids"><span class="toc-text">Boundary conditions for non-orthogonal grids</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Dirichlet-BC-phi-b"><span class="toc-text">Dirichlet BC ($\phi_b$)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Neumann"><span class="toc-text">Neumann</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Skewness"><span class="toc-text">Skewness</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Under-relaxation-of-the-interative-solution-process"><span class="toc-text">Under relaxation of the interative solution process</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%BE%E5%BC%8F"><span class="toc-text">显式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%90%E5%BC%8F"><span class="toc-text">隐式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OpenFOAM"><span class="toc-text">OpenFOAM</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>蓝皮书 Ch4<br>红皮书 Ch8<br>101F  relaxation<br>作业：P206,Ex3,P269,Ex7</p>
<h1 id="二维扩散方程"><a href="#二维扩散方程" class="headerlink" title="二维扩散方程"></a>二维扩散方程</h1><script type="math/tex; mode=display">
\begin{aligned}
-\nabla \cdot (D\nabla \phi)=Q  \\ \frac{\partial }{\partial x}D\frac{\partial \phi}{\partial x}+\frac{\partial }{\partial y}D\frac{\partial \phi}{\partial y}+Q=0 
\end{aligned}</script><h2 id="离散-（Two-dimensional-diffusion-in-a-rectangular-domain"><a href="#离散-（Two-dimensional-diffusion-in-a-rectangular-domain" class="headerlink" title="离散 （Two dimensional diffusion in a rectangular domain)"></a>离散 （Two dimensional diffusion in a rectangular domain)</h2><script type="math/tex; mode=display">
\begin{aligned}
\\ \color{grey}{ \int_V \nabla \cdot (D\nabla \phi)dV+\int_VQdV=0} \\ \color{grey}{\sum_{f}\int_f (D\nabla \phi)d\vec{S}+Q_PV_P = 0}\\\boxed{ \sum_{f}(D \nabla \phi)_f\cdot \vec{S}_f+Q_PV_P=0}
\end{aligned}</script><p>gradient $(\nabla \phi)_f\begin{cases}<br>   \frac{\phi_N-\phi_P}{\Delta PN} \\ a(\nabla \phi)_P+b(\nabla \phi)_N<br>\end{cases}$</p>
<p><img src="https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-07_12-57.png" alt=""></p>
<ul>
<li><p>East</p>
<script type="math/tex; mode=display">
\begin{aligned}
  \boldsymbol{S}_e&=\Delta y\boldsymbol{i}
\\ D(\nabla \phi)_e\cdot \boldsymbol{S}_e&\color{grey}{=D\left(\frac{\partial \phi}{\partial x}\boldsymbol{i}+\frac{\partial \phi}{\partial y}\boldsymbol{j}\right)\cdot S_e\boldsymbol{i}=\Delta yD \left(\frac{\partial \phi}{\partial x}\right)_e=\Delta y D \frac{\phi_E-\phi_P}{\delta x_{PE}}=a_E(\phi_E-\phi_P)}
\end{aligned}</script></li>
<li><p>West</p>
<script type="math/tex; mode=display">
\begin{aligned}
  \boldsymbol{S}_w&=-\Delta y\boldsymbol{i}
\\ D(\nabla \phi)_w\cdot \boldsymbol{S}_w&\color{grey}{=D\left(\frac{\partial \phi}{\partial x}\boldsymbol{i}+\frac{\partial \phi}{\partial y}\boldsymbol{j}\right)\cdot S_w\boldsymbol{i}=-\Delta yD \left(\frac{\partial \phi}{\partial x}\right)_w=-\Delta y D \frac{\phi_P-\phi_W}{\delta x_{WP}}=\Delta y D\frac{\phi_W-\phi_P}{\delta x_{WP}}=a_W(\phi_W-\phi_P)}
\end{aligned}</script></li>
<li><p>South</p>
<script type="math/tex; mode=display">
\begin{aligned}
  \boldsymbol{S}_s&=-\Delta x\boldsymbol{j}
\\ D(\nabla \phi)_s\cdot \boldsymbol{S}_s&\color{grey}{=D\left(\frac{\partial \phi}{\partial x}\boldsymbol{i}+\frac{\partial \phi}{\partial y}\boldsymbol{j}\right)\cdot S_s\boldsymbol{j}=-\Delta xD \left(\frac{\partial \phi}{\partial y}\right)_s=-\Delta x D \frac{\phi_P-\phi_S}{\delta y_{SP}}=\Delta x D\frac{\phi_S-\phi_P}{\delta y_{SP}}=a_S(\phi_S-\phi_P)}
\end{aligned}</script></li>
<li><p>North</p>
<script type="math/tex; mode=display">
\begin{aligned}
  \boldsymbol{S}_n&=\Delta x\boldsymbol{j}
\\ D(\nabla \phi)_n\cdot \boldsymbol{S}_n&=\color{grey}{D\left(\frac{\partial \phi}{\partial x}\boldsymbol{i}+\frac{\partial \phi}{\partial y}\boldsymbol{j}\right)\cdot S_n\boldsymbol{j}=\Delta xD \left(\frac{\partial \phi}{\partial y}\right)_n=\Delta x D \frac{\phi_N-\phi_P}{\delta y_{PN}}=a_N(\phi_N-\phi_P)}
\end{aligned}</script></li>
</ul>
<h3 id="源项"><a href="#源项" class="headerlink" title="源项"></a>源项</h3><script type="math/tex; mode=display">
  Q_PV_P=Q_u+Q_S\phi_P</script><h3 id="代数方程"><a href="#代数方程" class="headerlink" title="代数方程"></a>代数方程</h3><script type="math/tex; mode=display">
{\color{grey}{(-a_E-a_W-a_S-a_N)\phi_P+a_E\phi_E+a_W\phi_W+a_S\phi_S+a_N\phi_N+Q_u+Q_S\phi_P}=0}</script><ul>
<li>若无源项，系数零和</li>
<li>若$Q_s$与其他系数反号，破坏对角占优;反之若同号，加强对角占优</li>
<li><p>放到方程左侧系数矩阵，属于隐式离散</p>
<script type="math/tex; mode=display">
\begin{aligned}
a_P\phi_P&=a_W\phi_W+a_E\phi_E+a_S\phi_S+a_N\phi_N+Q_u
\\ a_P&=a_W+a_E+a_S+a_N-{\color{red}{Q_S}}
\end{aligned}</script></li>
<li><p>注意边界条件</p>
</li>
</ul>
<h2 id="Boundary-condition"><a href="#Boundary-condition" class="headerlink" title="Boundary condition"></a>Boundary condition</h2><p><img align="right" src=https://cdn.jsdelivr.net/gh/TeresaClay/blogImage@main/img/2022-08-07_14-54.png></p>
<ul>
<li><p>Dirichlet: $\phi_b$</p>
<script type="math/tex; mode=display">
D(\nabla \phi)_b \cdot \vec{S}_f=D \frac{\phi_b-\phi_P}{\delta x_{Pb}}\cdot \Delta y =\frac{\Delta y D}{\delta x _{Pb}}(\phi_b-\phi_P) \quad=a_b\phi_b-a_b\phi_P</script><script type="math/tex; mode=display">
\underbrace{(a_W+a_N+a_S+{\color{red}{a_b}})}_{a_P}\phi_P-(a_N\phi_N+a_W\phi_W+a_S\phi_S)=a_b\phi_b</script><ul>
<li>Dirichlet边界条件加强对角系数</li>
</ul>
</li>
<li><p>Neumann: $(D\nabla \phi)_b\cdot \vec{i}=q$</p>
<script type="math/tex; mode=display">
D(\nabla \phi)_b\cdot \vec{S}_b=(D\nabla \phi)_b\cdot \Delta y \vec{i}=q \Delta y</script><script type="math/tex; mode=display">
\underbrace{(a_W+a_N+a_S)}_{a_P}\phi_P+a_N\phi_N+a_W\phi_W+a_S\phi_S+q\Delta y=0</script><ul>
<li>梯度边界条件对 $a_P$无影响</li>
<li>zeroGradient 零梯度, $\phi_P=\phi_b$</li>
</ul>
</li>
</ul>
<h2 id="Interface-diffusivity"><a href="#Interface-diffusivity" class="headerlink" title="Interface diffusivity"></a>Interface diffusivity</h2><p>Jasak 3.3.4,</p>
<script type="math/tex; mode=display">
D_e=(1-\gamma_e)D_P+\gamma_eD_E \qquad \gamma_e=\frac{d_{pe}}{d_{pe}+d_{eE}}</script><h2 id="Example-1-P227"><a href="#Example-1-P227" class="headerlink" title="Example 1 P227"></a>Example 1 P227</h2><ul>
<li>GS，Jacobian，python 代码</li>
</ul>
<hr>
<h1 id="非结构化网格-non-orthogonal"><a href="#非结构化网格-non-orthogonal" class="headerlink" title="非结构化网格 non orthogonal"></a>非结构化网格 non orthogonal</h1><ul>
<li>可将 $(\nabla \phi)_f \cdot \boldsymbol{S}_f$ 分为两个部分处理<br><img src="images/2022-07-30-15-02-33.png" alt=""><script type="math/tex; mode=display">
(\nabla \phi)_f\cdot \boldsymbol{S}_f=\underbrace{(\nabla\phi)_f\cdot \Delta}_{正交贡献 \text{implicit}}+\underbrace{(\nabla \phi)_f\cdot\boldsymbol{k}}_{非正交修正 \text{explicit (corss-diffusion, as a source term)}}</script></li>
</ul>
<h2 id="三种分解方式"><a href="#三种分解方式" class="headerlink" title="三种分解方式"></a>三种分解方式</h2><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>minimum correction</strong><br>$\begin{aligned} \left\vert \vec{\Delta} \right\vert &amp; =\left\vert \vec{S}_f \right\vert \cos \theta =\vec{S}_f\cdot \vec{e}_{PN} \\ \vec{e}_{PN}&amp;=\frac{\vec{PN}}{\left\vert \vec{PN} \right\vert }= \frac{\vec{r}_N-\vec{r}_P}{\left\vert \vec{r}_N-\vec{r}_P \right\vert }\\ \vec{\Delta}&amp; =(\vec{S}_f\cdot \vec{e}_f)\vec{e}_f =\left\vert \vec{S}_f \right\vert \cos \theta\cdot \vec{e}_{PN} \\ \\ \vec{e}_{PN}\cdot \vec{e}_{k}&amp;=0 \end{aligned}$</td>
<td><img src="/images/2022-07-30-15-27-29.png" alt=""></td>
</tr>
<tr>
<td><strong>orthogonal correction</strong> <br>$\vec{\Delta}=\left\vert \vec{S}_f \right\vert \cdot \vec{e}_{PN}$</td>
<td><img src="/images/2022-07-30-15-30-38.png" alt=""></td>
</tr>
<tr>
<td><strong>over-relaxed correction</strong><br>$\vec{\Delta}=\frac{\left\vert \vec{S}_f \right\vert }{\cos \theta}\vec{e}_{PN}$</td>
<td><img src="/images/2022-07-30-15-34-12.png" alt=""></td>
</tr>
</tbody>
</table>
</div>
<h2 id="复习"><a href="#复习" class="headerlink" title="复习"></a>复习</h2><ul>
<li>梯度计算<script type="math/tex; mode=display">
\overline{\nabla \phi}_P=\frac{1}{V_P}\int_{V_c}\nabla \phi dV=\frac{1}{V_P}\int_{\partial V_P}\phi d\boldsymbol{S}</script></li>
<li>梯度离散<script type="math/tex; mode=display">
\overline{\nabla \phi}_P=\frac{1}{V_P}\sum_{f}\int_{f}\phi d\boldsymbol{S}=\frac{1}{V_P}\sum_{f}\phi_f\boldsymbol{S}_f</script></li>
<li>面心梯度 （带着权重的向量和成）<script type="math/tex; mode=display">
(\nabla \phi)_f=g_N(\nabla \phi)_N+g_P(\nabla \phi)_P \\ g_N=\frac{V_P}{V_P+V_N} \qquad g_P=\frac{V_N}{V_P+V_N}</script></li>
</ul>
<h2 id="Algebraic-equation-for-non-orthogonal-meshes"><a href="#Algebraic-equation-for-non-orthogonal-meshes" class="headerlink" title="Algebraic equation for non-orthogonal meshes"></a>Algebraic equation for non-orthogonal meshes</h2><script type="math/tex; mode=display">
\begin{aligned}
\sum_{f}(D\nabla \phi)_f\cdot \boldsymbol{S}_f&=\sum_{f}((D\nabla \phi)_f\cdot (\vec{\Delta}+\boldsymbol{k}))\\&=\sum_{f}(D\nabla \phi)_f\cdot \vec{\Delta}+\sum_{f}(D\nabla \phi)_f\cdot \boldsymbol{k} \\ &=\boxed{\sum_{f}\left(D \frac{\phi_{N}-\phi_{P}}{PN}\right)\left\vert \Delta \right\vert+\sum_{f}(D \nabla  \phi)_f\cdot \boldsymbol{k}} 
\end{aligned}</script><h3 id="矩阵形式"><a href="#矩阵形式" class="headerlink" title="矩阵形式"></a>矩阵形式</h3><script type="math/tex; mode=display">
  a_P\phi_P+\sum_{f}a_N\phi_N=b_P
  \\ \qquad
    a_N=\frac{D}{PN}\left\vert \Delta \right\vert _f \qquad a_P=-\sum_{f}\frac{D}{PN}\left\vert \Delta \right\vert _f \qquad b_P=Q_PV_P-\sum_{f}(D \nabla  \phi)\cdot \boldsymbol{k}</script><h2 id="Example-2-P246"><a href="#Example-2-P246" class="headerlink" title="Example 2 (P246)"></a>Example 2 (P246)</h2><ul>
<li>编程玩一下<script type="math/tex; mode=display">
\begin{aligned}
\phi&=x^{2}+y^{2}+x^{2}y^{2} \qquad V_C=8.625
\\ \text{analytical gradient: }\nabla \phi&=\begin{bmatrix} \frac{\partial \phi}{\partial x} \\ \frac{\partial \phi}{\partial y} \\\end{bmatrix}=\begin{bmatrix} 2x+2xy^{2} \\ 2y+2x^{2}y \\\end{bmatrix} 
\\ \nabla \phi_F&=\begin{bmatrix} 112.625  \\ 133.4375 \\\end{bmatrix} \qquad \nabla \phi_{f_1}=\begin{bmatrix} 51.375 \\ 55 \\\end{bmatrix}
\end{aligned}</script></li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>location</th>
<th>$\phi$</th>
<th>$\boldsymbol{S}$</th>
</tr>
</thead>
<tbody>
<tr>
<td>$C$</td>
<td>$\begin{bmatrix} 1.75 \\ 2 \\\end{bmatrix}$</td>
<td>19.3125</td>
</tr>
<tr>
<td>$F$</td>
<td>$\begin{bmatrix} 4.25 \\ 3.5 \\\end{bmatrix}$</td>
</tr>
<tr>
<td>$f_1$</td>
<td>$\begin{bmatrix} 3 \\ 2.75 \\\end{bmatrix}$</td>
<td>84.625</td>
<td>$\begin{bmatrix} 2.5 \\ 1 \\\end{bmatrix}$</td>
</tr>
<tr>
<td>$f_2$</td>
<td>$\begin{bmatrix} 1.5 \\ 3.5 \\\end{bmatrix}$</td>
<td>42.0625</td>
<td>$\begin{bmatrix} -1 \\ 2 \\\end{bmatrix}$</td>
</tr>
<tr>
<td>$f_3$</td>
<td>$\begin{bmatrix} 0.25 \\ 2 \\\end{bmatrix}$</td>
<td>4.3125</td>
<td>$\begin{bmatrix} -2 \\ 0.5 \\\end{bmatrix}$</td>
</tr>
<tr>
<td>$f_4$</td>
<td>$\begin{bmatrix} 1 \\ 0.5 \\\end{bmatrix}$</td>
<td>1.5</td>
<td>$\begin{bmatrix} -1 \\ -2 \\\end{bmatrix}$</td>
</tr>
<tr>
<td>$f_5$</td>
<td>$\begin{bmatrix} 2.75 \\ 0.75 \\\end{bmatrix}$</td>
<td>12.3789</td>
<td>$\begin{bmatrix} 1.5 \\ -1.5 \\\end{bmatrix}$</td>
</tr>
</tbody>
</table>
</div>
<ol>
<li>$\nabla \phi_C=\frac{1}{V_C}\sum_{f}\phi_f\boldsymbol{S}_f=\begin{bmatrix} 20.63 \\ 17.31 \\\end{bmatrix}$</li>
</ol>
<ul>
<li>numerical和analytical的差异很大，由于网格较大  </li>
</ul>
<ol>
<li>$ \nabla \phi_{f_1}=g_{f_1}\nabla \phi_F+(1-g_{f_1})\nabla \phi_{C}=\begin{bmatrix} 66.63 \\ 75.38 \\\end{bmatrix} \\ g_{f_1}=\frac{d_{Cf_1}}{d_{Cf_1}+d_{f_1F}}=0.5$</li>
</ol>
<h2 id="Boundary-conditions-for-non-orthogonal-grids"><a href="#Boundary-conditions-for-non-orthogonal-grids" class="headerlink" title="Boundary conditions for non-orthogonal grids"></a>Boundary conditions for non-orthogonal grids</h2><h3 id="Dirichlet-BC-phi-b"><a href="#Dirichlet-BC-phi-b" class="headerlink" title="Dirichlet BC ($\phi_b$)"></a>Dirichlet BC ($\phi_b$)</h3><script type="math/tex; mode=display">
\begin{aligned}
(\nabla  \phi)_b&=\frac{\phi_b-\phi_P}{Pb} 
\\ (\nabla \phi)_b\cdot \vec{S}_f&=(\nabla \phi)_b\cdot (\vec{\Delta}+\boldsymbol{k})=\frac{\phi_b-\phi_P}{Pb}\left\vert \vec{\Delta} \right\vert + (\nabla \phi)_b\cdot \boldsymbol{k}
\end{aligned}</script><h3 id="Neumann"><a href="#Neumann" class="headerlink" title="Neumann"></a>Neumann</h3><script type="math/tex; mode=display">
(D \nabla \phi)_b\cdot \boldsymbol{S}_f=q_b\left\vert \boldsymbol{S}_f \right\vert</script><h2 id="Skewness"><a href="#Skewness" class="headerlink" title="Skewness"></a>Skewness</h2><p> <img src="/images/2022-07-17-00-05-43.png" alt=""></p>
<script type="math/tex; mode=display">
\phi_f=\phi_{f^{'}}+(\nabla \phi)_{f^{'}}\cdot \boldsymbol{d}_{f^{'}f}</script><hr>
<h1 id="Under-relaxation-of-the-interative-solution-process"><a href="#Under-relaxation-of-the-interative-solution-process" class="headerlink" title="Under relaxation of the interative solution process"></a>Under relaxation of the interative solution process</h1><p>Jasak(3.6)<br>slowing down the changes in $\phi$ between iterations</p>
<ul>
<li>代数方程组<script type="math/tex; mode=display">
a_P\phi_P+\sum_{f}a_N\phi_N=b_P 
\\ \phi_P=\frac{b_P-\sum_{f}a_N\phi_N}{a_P}</script></li>
</ul>
<h2 id="显式"><a href="#显式" class="headerlink" title="显式"></a>显式</h2><ul>
<li>在右边加减 $\phi_P^{\text{old}}$ <script type="math/tex; mode=display">
\phi_P^{\text{new}}=\phi_P^{\text{old}}+\alpha\left(\underbrace{\frac{b_P-\sum_{f}a_N\phi_N^{\text{old}}}{a_P}-\phi_{P}^{\text{old}}}_{\text{change in }\phi_P \text{ in the current iteration}} \right)</script></li>
<li>无需构造系数矩阵，直接代数计算 （Jacobi）</li>
<li>stable, false converge?</li>
</ul>
<h2 id="隐式"><a href="#隐式" class="headerlink" title="隐式"></a>隐式</h2><script type="math/tex; mode=display">
\frac{a_P}{\alpha}\phi_P+\sum_{f}a_N\phi_N=b_P+\frac{(1-\alpha)a_P}{\alpha}\phi_P^{\text{old}}</script><h2 id="OpenFOAM"><a href="#OpenFOAM" class="headerlink" title="OpenFOAM"></a>OpenFOAM</h2><ul>
<li>显式，fields p 0.3</li>
<li>隐式, equations U 0.9</li>
<li>区分  SIMPLE 和 SIMPLEC</li>
<li><a target="_blank" rel="noopener" href="https://www.simscale.com/docs/simulation-setup/numerics/relaxation-factors/">SIMSCALE</a></li>
</ul>

      
       
    </div>
</article>







    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="//cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<input type="hidden" id="MathJax-js"
        value="//cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</input>
    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2022 TeresaClay
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        
        $('pre code').each(function(){
            var lines = $(this).text().trim().split('\n').length, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*访问数量*/
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: ;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 642px;
    }
    .nav.fullscreen {
        margin-left: -642px;
    }
    .nav-left {
        width: 220px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 592px;
        }
        .nav.fullscreen {
            margin-left: -592px;
        }
        .nav-left {
            width: 200px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 592px;
            margin-left: -592px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
    #post .pjax article :not(pre) > code {
        color: #24292e;
        font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
        background-color: rgba(27,31,35,.05);
        border-radius: 3px;
        font-size: 85%;
        margin: 0;
        padding: .2em .4em;
    }
    
</style>







</html>
